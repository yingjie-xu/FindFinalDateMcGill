{"version":3,"sources":["affix/index.jsx"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","React","polyfill","classNames","omit","ResizeObserver","ConfigConsumer","throttleByAnimationFrameDecorator","warning","addObserveTarget","removeObserveTarget","getTargetRect","getFixedTop","getFixedBottom","getDefaultTarget","window","AffixStatus","Affix","state","status","None","lastAffix","prevTarget","getOffsetTop","props","offset","offsetBottom","offsetTop","undefined","getOffsetBottom","savePlaceholderNode","node","placeholderNode","saveFixedNode","fixedNode","measure","onChange","Prepare","targetNode","newState","targetRect","placeholderReact","fixedTop","fixedBottom","affixStyle","position","top","width","height","placeholderStyle","bottom","setState","prepareMeasure","process","env","NODE_ENV","onTestUpdatePosition","renderAffix","getPrefixCls","prefixCls","children","className","updatePosition","timeout","setTimeout","prevProps","newTarget","clearTimeout","cancel","Component","defaultProps","prototype"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,UAAU,GAAI,QAAQ,KAAKA,UAAd,IAA6B,UAAUC,UAAV,EAAsBC,MAAtB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AACnF,MAAIC,CAAC,GAAGC,SAAS,CAACC,MAAlB;AAAA,MAA0BC,CAAC,GAAGH,CAAC,GAAG,CAAJ,GAAQH,MAAR,GAAiBE,IAAI,KAAK,IAAT,GAAgBA,IAAI,GAAGK,MAAM,CAACC,wBAAP,CAAgCR,MAAhC,EAAwCC,GAAxC,CAAvB,GAAsEC,IAArH;AAAA,MAA2HO,CAA3H;AACA,MAAI,QAAOC,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOA,OAAO,CAACC,QAAf,KAA4B,UAA/D,EAA2EL,CAAC,GAAGI,OAAO,CAACC,QAAR,CAAiBZ,UAAjB,EAA6BC,MAA7B,EAAqCC,GAArC,EAA0CC,IAA1C,CAAJ,CAA3E,KACK,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAX,GAAoB,CAAjC,EAAoCO,CAAC,IAAI,CAAzC,EAA4CA,CAAC,EAA7C;AAAiD,QAAIH,CAAC,GAAGV,UAAU,CAACa,CAAD,CAAlB,EAAuBN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAJ,GAAQM,CAAC,CAACH,CAAD,CAAT,GAAeH,CAAC,GAAG,CAAJ,GAAQM,CAAC,CAACT,MAAD,EAASC,GAAT,EAAcK,CAAd,CAAT,GAA4BG,CAAC,CAACT,MAAD,EAASC,GAAT,CAA7C,KAA+DK,CAAnE;AAAxE;AACL,SAAOH,CAAC,GAAG,CAAJ,IAASG,CAAT,IAAcC,MAAM,CAACM,cAAP,CAAsBb,MAAtB,EAA8BC,GAA9B,EAAmCK,CAAnC,CAAd,EAAqDA,CAA5D;AACH,CALD;;AAMA,OAAO,KAAKQ,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,IAAP,MAAiB,SAAjB;AACA,OAAOC,cAAP,MAA2B,oBAA3B;AACA,SAASC,cAAT,QAA+B,oBAA/B;AACA,SAASC,iCAAT,QAAkD,mCAAlD;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,SAASC,gBAAT,EAA2BC,mBAA3B,EAAgDC,aAAhD,EAA+DC,WAA/D,EAA4EC,cAA5E,QAAmG,SAAnG;;AACA,SAASC,gBAAT,GAA4B;AACxB,SAAO,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,IAAhD;AACH;;AACD,IAAIC,WAAJ;;AACA,CAAC,UAAUA,WAAV,EAAuB;AACpBA,EAAAA,WAAW,CAACA,WAAW,CAAC,MAAD,CAAX,GAAsB,CAAvB,CAAX,GAAuC,MAAvC;AACAA,EAAAA,WAAW,CAACA,WAAW,CAAC,SAAD,CAAX,GAAyB,CAA1B,CAAX,GAA0C,SAA1C;AACH,CAHD,EAGGA,WAAW,KAAKA,WAAW,GAAG,EAAnB,CAHd;;IAIMC,K;;;;;AACF,mBAAc;AAAA;;AAAA;;AACV,gFAAS1B,SAAT;AACA,UAAK2B,KAAL,GAAa;AACTC,MAAAA,MAAM,EAAEH,WAAW,CAACI,IADX;AAETC,MAAAA,SAAS,EAAE,KAFF;AAGTC,MAAAA,UAAU,EAAE;AAHH,KAAb;;AAKA,UAAKC,YAAL,GAAoB,YAAM;AAAA,wBACW,MAAKC,KADhB;AAAA,UACdC,MADc,eACdA,MADc;AAAA,UACNC,YADM,eACNA,YADM;AAAA,UAEhBC,SAFgB,GAEF,MAAKH,KAFH,CAEhBG,SAFgB;;AAGtB,UAAI,OAAOA,SAAP,KAAqB,WAAzB,EAAsC;AAClCA,QAAAA,SAAS,GAAGF,MAAZ;AACAjB,QAAAA,OAAO,CAAC,OAAOiB,MAAP,KAAkB,WAAnB,EAAgC,OAAhC,EAAyC,yDAAzC,CAAP;AACH;;AACD,UAAIC,YAAY,KAAKE,SAAjB,IAA8BD,SAAS,KAAKC,SAAhD,EAA2D;AACvDD,QAAAA,SAAS,GAAG,CAAZ;AACH;;AACD,aAAOA,SAAP;AACH,KAXD;;AAYA,UAAKE,eAAL,GAAuB,YAAM;AACzB,aAAO,MAAKL,KAAL,CAAWE,YAAlB;AACH,KAFD;;AAGA,UAAKI,mBAAL,GAA2B,UAACC,IAAD,EAAU;AACjC,YAAKC,eAAL,GAAuBD,IAAvB;AACH,KAFD;;AAGA,UAAKE,aAAL,GAAqB,UAACF,IAAD,EAAU;AAC3B,YAAKG,SAAL,GAAiBH,IAAjB;AACH,KAFD,CAzBU,CA4BV;;;AACA,UAAKI,OAAL,GAAe,YAAM;AAAA,wBACa,MAAKjB,KADlB;AAAA,UACTC,MADS,eACTA,MADS;AAAA,UACDE,SADC,eACDA,SADC;AAAA,yBAEY,MAAKG,KAFjB;AAAA,UAETrC,MAFS,gBAETA,MAFS;AAAA,UAEDiD,QAFC,gBAEDA,QAFC;;AAGjB,UAAIjB,MAAM,KAAKH,WAAW,CAACqB,OAAvB,IAAkC,CAAC,MAAKH,SAAxC,IAAqD,CAAC,MAAKF,eAA3D,IAA8E,CAAC7C,MAAnF,EAA2F;AACvF;AACH;;AACD,UAAMwC,SAAS,GAAG,MAAKJ,YAAL,EAAlB;;AACA,UAAMG,YAAY,GAAG,MAAKG,eAAL,EAArB;;AACA,UAAMS,UAAU,GAAGnD,MAAM,EAAzB;;AACA,UAAI,CAACmD,UAAL,EAAiB;AACb;AACH;;AACD,UAAMC,QAAQ,GAAG;AACbpB,QAAAA,MAAM,EAAEH,WAAW,CAACI;AADP,OAAjB;AAGA,UAAMoB,UAAU,GAAG7B,aAAa,CAAC2B,UAAD,CAAhC;AACA,UAAMG,gBAAgB,GAAG9B,aAAa,CAAC,MAAKqB,eAAN,CAAtC;AACA,UAAMU,QAAQ,GAAG9B,WAAW,CAAC6B,gBAAD,EAAmBD,UAAnB,EAA+Bb,SAA/B,CAA5B;AACA,UAAMgB,WAAW,GAAG9B,cAAc,CAAC4B,gBAAD,EAAmBD,UAAnB,EAA+Bd,YAA/B,CAAlC;;AACA,UAAIgB,QAAQ,KAAKd,SAAjB,EAA4B;AACxBW,QAAAA,QAAQ,CAACK,UAAT,GAAsB;AAClBC,UAAAA,QAAQ,EAAE,OADQ;AAElBC,UAAAA,GAAG,EAAEJ,QAFa;AAGlBK,UAAAA,KAAK,EAAEN,gBAAgB,CAACM,KAHN;AAIlBC,UAAAA,MAAM,EAAEP,gBAAgB,CAACO;AAJP,SAAtB;AAMAT,QAAAA,QAAQ,CAACU,gBAAT,GAA4B;AACxBF,UAAAA,KAAK,EAAEN,gBAAgB,CAACM,KADA;AAExBC,UAAAA,MAAM,EAAEP,gBAAgB,CAACO;AAFD,SAA5B;AAIH,OAXD,MAYK,IAAIL,WAAW,KAAKf,SAApB,EAA+B;AAChCW,QAAAA,QAAQ,CAACK,UAAT,GAAsB;AAClBC,UAAAA,QAAQ,EAAE,OADQ;AAElBK,UAAAA,MAAM,EAAEP,WAFU;AAGlBI,UAAAA,KAAK,EAAEN,gBAAgB,CAACM,KAHN;AAIlBC,UAAAA,MAAM,EAAEP,gBAAgB,CAACO;AAJP,SAAtB;AAMAT,QAAAA,QAAQ,CAACU,gBAAT,GAA4B;AACxBF,UAAAA,KAAK,EAAEN,gBAAgB,CAACM,KADA;AAExBC,UAAAA,MAAM,EAAEP,gBAAgB,CAACO;AAFD,SAA5B;AAIH;;AACDT,MAAAA,QAAQ,CAAClB,SAAT,GAAqB,CAAC,CAACkB,QAAQ,CAACK,UAAhC;;AACA,UAAIR,QAAQ,IAAIf,SAAS,KAAKkB,QAAQ,CAAClB,SAAvC,EAAkD;AAC9Ce,QAAAA,QAAQ,CAACG,QAAQ,CAAClB,SAAV,CAAR;AACH;;AACD,YAAK8B,QAAL,CAAcZ,QAAd;AACH,KAhDD,CA7BU,CA8EV;;;AACA,UAAKa,cAAL,GAAsB,YAAM;AACxB;AACA,YAAKD,QAAL,CAAc;AACVhC,QAAAA,MAAM,EAAEH,WAAW,CAACqB,OADV;AAEVO,QAAAA,UAAU,EAAEhB,SAFF;AAGVqB,QAAAA,gBAAgB,EAAErB;AAHR,OAAd,EAFwB,CAOxB;;;AACA,UAAIyB,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,MAA7B,EAAqC;AAAA,YACzBC,oBADyB,GACA,MAAKhC,KADL,CACzBgC,oBADyB;;AAEjC,YAAIA,oBAAJ,EAA0B;AACtBA,UAAAA,oBAAoB;AACvB;AACJ;AACJ,KAdD,CA/EU,CA8FV;;;AACA,UAAKC,WAAL,GAAmB,gBAAsB;AAAA,UAAnBC,YAAmB,QAAnBA,YAAmB;AAAA,yBACI,MAAKxC,KADT;AAAA,UAC7B0B,UAD6B,gBAC7BA,UAD6B;AAAA,UACjBK,gBADiB,gBACjBA,gBADiB;AAAA,yBAEL,MAAKzB,KAFA;AAAA,UAE7BmC,SAF6B,gBAE7BA,SAF6B;AAAA,UAElBC,QAFkB,gBAElBA,QAFkB;AAGrC,UAAMC,SAAS,GAAG1D,UAAU,qBACvBuD,YAAY,CAAC,OAAD,EAAUC,SAAV,CADW,EACYf,UADZ,EAA5B;AAGA,UAAIpB,KAAK,GAAGpB,IAAI,CAAC,MAAKoB,KAAN,EAAa,CAAC,WAAD,EAAc,WAAd,EAA2B,cAA3B,EAA2C,QAA3C,EAAqD,UAArD,CAAb,CAAhB,CANqC,CAOrC;;AACA,UAAI6B,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,MAA7B,EAAqC;AACjC/B,QAAAA,KAAK,GAAGpB,IAAI,CAACoB,KAAD,EAAQ,CAAC,sBAAD,CAAR,CAAZ;AACH;;AACD,aAAQ,oBAAC,cAAD;AAAgB,QAAA,QAAQ,EAAE,oBAAM;AACpC,gBAAKsC,cAAL;AACH;AAFO,SAGZ,wCAAStC,KAAT;AAAgB,QAAA,GAAG,EAAE,MAAKM;AAA1B,UACGc,UAAU,IAAI;AAAK,QAAA,KAAK,EAAEK,gBAAZ;AAA8B,uBAAY;AAA1C,QADjB,EAEE;AAAK,QAAA,SAAS,EAAEY,SAAhB;AAA2B,QAAA,GAAG,EAAE,MAAK5B,aAArC;AAAoD,QAAA,KAAK,EAAEW;AAA3D,SACE,oBAAC,cAAD;AAAgB,QAAA,QAAQ,EAAE,oBAAM;AAC5B,gBAAKkB,cAAL;AACH;AAFD,SAGGF,QAHH,CADF,CAFF,CAHY,CAAR;AAcH,KAzBD;;AA/FU;AAyHb,G,CACD;;;;;wCACoB;AAAA;;AAAA,UACRzE,MADQ,GACG,KAAKqC,KADR,CACRrC,MADQ;;AAEhB,UAAIA,MAAJ,EAAY;AACR;AACA;AACA,aAAK4E,OAAL,GAAeC,UAAU,CAAC,YAAM;AAC5BvD,UAAAA,gBAAgB,CAACtB,MAAM,EAAP,EAAW,MAAX,CAAhB,CAD4B,CAE5B;;AACA,UAAA,MAAI,CAAC2E,cAAL;AACH,SAJwB,CAAzB;AAKH;AACJ;;;uCACkBG,S,EAAW;AAAA,UAClB3C,UADkB,GACH,KAAKJ,KADF,CAClBI,UADkB;AAAA,UAElBnC,MAFkB,GAEP,KAAKqC,KAFE,CAElBrC,MAFkB;AAG1B,UAAI+E,SAAS,GAAG,IAAhB;;AACA,UAAI/E,MAAJ,EAAY;AACR+E,QAAAA,SAAS,GAAG/E,MAAM,MAAM,IAAxB;AACH;;AACD,UAAImC,UAAU,KAAK4C,SAAnB,EAA8B;AAC1BxD,QAAAA,mBAAmB,CAAC,IAAD,CAAnB;;AACA,YAAIwD,SAAJ,EAAe;AACXzD,UAAAA,gBAAgB,CAACyD,SAAD,EAAY,IAAZ,CAAhB,CADW,CAEX;;AACA,eAAKJ,cAAL;AACH;;AACD,aAAKX,QAAL,CAAc;AAAE7B,UAAAA,UAAU,EAAE4C;AAAd,SAAd;AACH;;AACD,UAAID,SAAS,CAACtC,SAAV,KAAwB,KAAKH,KAAL,CAAWG,SAAnC,IACAsC,SAAS,CAACvC,YAAV,KAA2B,KAAKF,KAAL,CAAWE,YAD1C,EACwD;AACpD,aAAKoC,cAAL;AACH;;AACD,WAAK3B,OAAL;AACH;;;2CACsB;AACnBgC,MAAAA,YAAY,CAAC,KAAKJ,OAAN,CAAZ;AACArD,MAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACA,WAAKoD,cAAL,CAAoBM,MAApB;AACH,K,CACD;;;;qCACiB;AACb,WAAKhB,cAAL;AACH;;;yCACoB;AAAA,UACTjE,MADS,GACE,KAAKqC,KADP,CACTrC,MADS;AAAA,UAETyD,UAFS,GAEM,KAAK1B,KAFX,CAET0B,UAFS,EAGjB;;AACA,UAAIzD,MAAM,IAAIyD,UAAd,EAA0B;AACtB,YAAMjB,SAAS,GAAG,KAAKJ,YAAL,EAAlB;AACA,YAAMG,YAAY,GAAG,KAAKG,eAAL,EAArB;AACA,YAAMS,UAAU,GAAGnD,MAAM,EAAzB;;AACA,YAAImD,UAAJ,EAAgB;AACZ,cAAME,UAAU,GAAG7B,aAAa,CAAC2B,UAAD,CAAhC;AACA,cAAMG,gBAAgB,GAAG9B,aAAa,CAAC,KAAKqB,eAAN,CAAtC;AACA,cAAMU,QAAQ,GAAG9B,WAAW,CAAC6B,gBAAD,EAAmBD,UAAnB,EAA+Bb,SAA/B,CAA5B;AACA,cAAMgB,WAAW,GAAG9B,cAAc,CAAC4B,gBAAD,EAAmBD,UAAnB,EAA+Bd,YAA/B,CAAlC;;AACA,cAAKgB,QAAQ,KAAKd,SAAb,IAA0BgB,UAAU,CAACE,GAAX,KAAmBJ,QAA9C,IACCC,WAAW,KAAKf,SAAhB,IAA6BgB,UAAU,CAACM,MAAX,KAAsBP,WADxD,EACsE;AAClE;AACH;AACJ;AACJ,OAlBgB,CAmBjB;;;AACA,WAAKS,cAAL;AACH;;;6BACQ;AACL,aAAO,oBAAC,cAAD,QAAiB,KAAKK,WAAtB,CAAP;AACH;;;;EA/LexD,KAAK,CAACoE,S;;AAiM1BpD,KAAK,CAACqD,YAAN,GAAqB;AACjBnF,EAAAA,MAAM,EAAE2B;AADS,CAArB;;AAGA7B,UAAU,CAAC,CACPsB,iCAAiC,EAD1B,CAAD,EAEPU,KAAK,CAACsD,SAFC,EAEU,gBAFV,EAE4B,IAF5B,CAAV;;AAGAtF,UAAU,CAAC,CACPsB,iCAAiC,EAD1B,CAAD,EAEPU,KAAK,CAACsD,SAFC,EAEU,oBAFV,EAEgC,IAFhC,CAAV;;AAGArE,QAAQ,CAACe,KAAD,CAAR;AACA,eAAeA,KAAf","sourcesContent":["var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport ResizeObserver from 'rc-resize-observer';\nimport { ConfigConsumer } from '../config-provider';\nimport { throttleByAnimationFrameDecorator } from '../_util/throttleByAnimationFrame';\nimport warning from '../_util/warning';\nimport { addObserveTarget, removeObserveTarget, getTargetRect, getFixedTop, getFixedBottom, } from './utils';\nfunction getDefaultTarget() {\n    return typeof window !== 'undefined' ? window : null;\n}\nvar AffixStatus;\n(function (AffixStatus) {\n    AffixStatus[AffixStatus[\"None\"] = 0] = \"None\";\n    AffixStatus[AffixStatus[\"Prepare\"] = 1] = \"Prepare\";\n})(AffixStatus || (AffixStatus = {}));\nclass Affix extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.state = {\n            status: AffixStatus.None,\n            lastAffix: false,\n            prevTarget: null,\n        };\n        this.getOffsetTop = () => {\n            const { offset, offsetBottom } = this.props;\n            let { offsetTop } = this.props;\n            if (typeof offsetTop === 'undefined') {\n                offsetTop = offset;\n                warning(typeof offset === 'undefined', 'Affix', '`offset` is deprecated. Please use `offsetTop` instead.');\n            }\n            if (offsetBottom === undefined && offsetTop === undefined) {\n                offsetTop = 0;\n            }\n            return offsetTop;\n        };\n        this.getOffsetBottom = () => {\n            return this.props.offsetBottom;\n        };\n        this.savePlaceholderNode = (node) => {\n            this.placeholderNode = node;\n        };\n        this.saveFixedNode = (node) => {\n            this.fixedNode = node;\n        };\n        // =================== Measure ===================\n        this.measure = () => {\n            const { status, lastAffix } = this.state;\n            const { target, onChange } = this.props;\n            if (status !== AffixStatus.Prepare || !this.fixedNode || !this.placeholderNode || !target) {\n                return;\n            }\n            const offsetTop = this.getOffsetTop();\n            const offsetBottom = this.getOffsetBottom();\n            const targetNode = target();\n            if (!targetNode) {\n                return;\n            }\n            const newState = {\n                status: AffixStatus.None,\n            };\n            const targetRect = getTargetRect(targetNode);\n            const placeholderReact = getTargetRect(this.placeholderNode);\n            const fixedTop = getFixedTop(placeholderReact, targetRect, offsetTop);\n            const fixedBottom = getFixedBottom(placeholderReact, targetRect, offsetBottom);\n            if (fixedTop !== undefined) {\n                newState.affixStyle = {\n                    position: 'fixed',\n                    top: fixedTop,\n                    width: placeholderReact.width,\n                    height: placeholderReact.height,\n                };\n                newState.placeholderStyle = {\n                    width: placeholderReact.width,\n                    height: placeholderReact.height,\n                };\n            }\n            else if (fixedBottom !== undefined) {\n                newState.affixStyle = {\n                    position: 'fixed',\n                    bottom: fixedBottom,\n                    width: placeholderReact.width,\n                    height: placeholderReact.height,\n                };\n                newState.placeholderStyle = {\n                    width: placeholderReact.width,\n                    height: placeholderReact.height,\n                };\n            }\n            newState.lastAffix = !!newState.affixStyle;\n            if (onChange && lastAffix !== newState.lastAffix) {\n                onChange(newState.lastAffix);\n            }\n            this.setState(newState);\n        };\n        // @ts-ignore TS6133\n        this.prepareMeasure = () => {\n            // event param is used before. Keep compatible ts define here.\n            this.setState({\n                status: AffixStatus.Prepare,\n                affixStyle: undefined,\n                placeholderStyle: undefined,\n            });\n            // Test if `updatePosition` called\n            if (process.env.NODE_ENV === 'test') {\n                const { onTestUpdatePosition } = this.props;\n                if (onTestUpdatePosition) {\n                    onTestUpdatePosition();\n                }\n            }\n        };\n        // =================== Render ===================\n        this.renderAffix = ({ getPrefixCls }) => {\n            const { affixStyle, placeholderStyle } = this.state;\n            const { prefixCls, children } = this.props;\n            const className = classNames({\n                [getPrefixCls('affix', prefixCls)]: affixStyle,\n            });\n            let props = omit(this.props, ['prefixCls', 'offsetTop', 'offsetBottom', 'target', 'onChange']);\n            // Omit this since `onTestUpdatePosition` only works on test.\n            if (process.env.NODE_ENV === 'test') {\n                props = omit(props, ['onTestUpdatePosition']);\n            }\n            return (<ResizeObserver onResize={() => {\n                this.updatePosition();\n            }}>\n        <div {...props} ref={this.savePlaceholderNode}>\n          {affixStyle && <div style={placeholderStyle} aria-hidden=\"true\"/>}\n          <div className={className} ref={this.saveFixedNode} style={affixStyle}>\n            <ResizeObserver onResize={() => {\n                this.updatePosition();\n            }}>\n              {children}\n            </ResizeObserver>\n          </div>\n        </div>\n      </ResizeObserver>);\n        };\n    }\n    // Event handler\n    componentDidMount() {\n        const { target } = this.props;\n        if (target) {\n            // [Legacy] Wait for parent component ref has its value.\n            // We should use target as directly element instead of function which makes element check hard.\n            this.timeout = setTimeout(() => {\n                addObserveTarget(target(), this);\n                // Mock Event object.\n                this.updatePosition();\n            });\n        }\n    }\n    componentDidUpdate(prevProps) {\n        const { prevTarget } = this.state;\n        const { target } = this.props;\n        let newTarget = null;\n        if (target) {\n            newTarget = target() || null;\n        }\n        if (prevTarget !== newTarget) {\n            removeObserveTarget(this);\n            if (newTarget) {\n                addObserveTarget(newTarget, this);\n                // Mock Event object.\n                this.updatePosition();\n            }\n            this.setState({ prevTarget: newTarget });\n        }\n        if (prevProps.offsetTop !== this.props.offsetTop ||\n            prevProps.offsetBottom !== this.props.offsetBottom) {\n            this.updatePosition();\n        }\n        this.measure();\n    }\n    componentWillUnmount() {\n        clearTimeout(this.timeout);\n        removeObserveTarget(this);\n        this.updatePosition.cancel();\n    }\n    // Handle realign logic\n    updatePosition() {\n        this.prepareMeasure();\n    }\n    lazyUpdatePosition() {\n        const { target } = this.props;\n        const { affixStyle } = this.state;\n        // Check position change before measure to make Safari smooth\n        if (target && affixStyle) {\n            const offsetTop = this.getOffsetTop();\n            const offsetBottom = this.getOffsetBottom();\n            const targetNode = target();\n            if (targetNode) {\n                const targetRect = getTargetRect(targetNode);\n                const placeholderReact = getTargetRect(this.placeholderNode);\n                const fixedTop = getFixedTop(placeholderReact, targetRect, offsetTop);\n                const fixedBottom = getFixedBottom(placeholderReact, targetRect, offsetBottom);\n                if ((fixedTop !== undefined && affixStyle.top === fixedTop) ||\n                    (fixedBottom !== undefined && affixStyle.bottom === fixedBottom)) {\n                    return;\n                }\n            }\n        }\n        // Directly call prepare measure since it's already throttled.\n        this.prepareMeasure();\n    }\n    render() {\n        return <ConfigConsumer>{this.renderAffix}</ConfigConsumer>;\n    }\n}\nAffix.defaultProps = {\n    target: getDefaultTarget,\n};\n__decorate([\n    throttleByAnimationFrameDecorator()\n], Affix.prototype, \"updatePosition\", null);\n__decorate([\n    throttleByAnimationFrameDecorator()\n], Affix.prototype, \"lazyUpdatePosition\", null);\npolyfill(Affix);\nexport default Affix;\n"],"file":"index.js"}