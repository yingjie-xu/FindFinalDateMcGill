{"version":3,"sources":["statistic/Countdown.jsx"],"names":["React","polyfill","moment","interopDefault","Statistic","formatCountdown","REFRESH_INTERVAL","getTime","value","valueOf","Countdown","arguments","syncTimer","props","timestamp","Date","now","startTimer","stopTimer","countdownId","window","setInterval","forceUpdate","onFinish","clearInterval","undefined","config","format","valueRender","node","cloneElement","title","Component","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,QAAyB,yBAAzB;AACA,OAAO,KAAKC,MAAZ,MAAwB,QAAxB;AACA,OAAOC,cAAP,MAA2B,yBAA3B;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,SAASC,eAAT,QAAgC,SAAhC;AACA,IAAMC,gBAAgB,GAAG,OAAO,EAAhC;;AACA,SAASC,OAAT,CAAiBC,KAAjB,EAAwB;AACpB,SAAOL,cAAc,CAACD,MAAD,CAAd,CAAuBM,KAAvB,EAA8BC,OAA9B,EAAP;AACH;;IACKC,S;;;;;AACF,uBAAc;AAAA;;AAAA;;AACV,oFAASC,SAAT;;AACA,UAAKC,SAAL,GAAiB,YAAM;AAAA,UACXJ,KADW,GACD,MAAKK,KADJ,CACXL,KADW;AAEnB,UAAMM,SAAS,GAAGP,OAAO,CAACC,KAAD,CAAzB;;AACA,UAAIM,SAAS,IAAIC,IAAI,CAACC,GAAL,EAAjB,EAA6B;AACzB,cAAKC,UAAL;AACH,OAFD,MAGK;AACD,cAAKC,SAAL;AACH;AACJ,KATD;;AAUA,UAAKD,UAAL,GAAkB,YAAM;AACpB,UAAI,MAAKE,WAAT,EACI;AACJ,YAAKA,WAAL,GAAmBC,MAAM,CAACC,WAAP,CAAmB,YAAM;AACxC,cAAKC,WAAL;AACH,OAFkB,EAEhBhB,gBAFgB,CAAnB;AAGH,KAND;;AAOA,UAAKY,SAAL,GAAiB,YAAM;AAAA,wBACS,MAAKL,KADd;AAAA,UACXU,QADW,eACXA,QADW;AAAA,UACDf,KADC,eACDA,KADC;;AAEnB,UAAI,MAAKW,WAAT,EAAsB;AAClBK,QAAAA,aAAa,CAAC,MAAKL,WAAN,CAAb;AACA,cAAKA,WAAL,GAAmBM,SAAnB;AACA,YAAMX,SAAS,GAAGP,OAAO,CAACC,KAAD,CAAzB;;AACA,YAAIe,QAAQ,IAAIT,SAAS,GAAGC,IAAI,CAACC,GAAL,EAA5B,EAAwC;AACpCO,UAAAA,QAAQ;AACX;AACJ;AACJ,KAVD;;AAWA,UAAKlB,eAAL,GAAuB,UAACG,KAAD,EAAQkB,MAAR,EAAmB;AAAA,UAC9BC,MAD8B,GACnB,MAAKd,KADc,CAC9Bc,MAD8B;AAEtC,aAAOtB,eAAe,CAACG,KAAD,EAAQ,SAAc,SAAc,EAAd,EAAkBkB,MAAlB,CAAd,EAAyC;AAAEC,QAAAA,MAAM,EAANA;AAAF,OAAzC,CAAR,CAAtB;AACH,KAHD,CA9BU,CAkCV;;;AACA,UAAKC,WAAL,GAAmB,UAACC,IAAD;AAAA,aAAU7B,KAAK,CAAC8B,YAAN,CAAmBD,IAAnB,EAAyB;AAClDE,QAAAA,KAAK,EAAEN;AAD2C,OAAzB,CAAV;AAAA,KAAnB;;AAnCU;AAsCb;;;;wCACmB;AAChB,WAAKb,SAAL;AACH;;;yCACoB;AACjB,WAAKA,SAAL;AACH;;;2CACsB;AACnB,WAAKM,SAAL;AACH;;;6BACQ;AACL,aAAQ,oBAAC,SAAD;AAAW,QAAA,WAAW,EAAE,KAAKU;AAA7B,SAA8C,KAAKf,KAAnD;AAA0D,QAAA,SAAS,EAAE,KAAKR;AAA1E,SAAR;AACH;;;;EAnDmBL,KAAK,CAACgC,S;;AAqD9BtB,SAAS,CAACuB,YAAV,GAAyB;AACrBN,EAAAA,MAAM,EAAE;AADa,CAAzB;AAGA1B,QAAQ,CAACS,SAAD,CAAR;AACA,eAAeA,SAAf","sourcesContent":["import * as React from 'react';\nimport { polyfill } from 'react-lifecycles-compat';\nimport * as moment from 'moment';\nimport interopDefault from '../_util/interopDefault';\nimport Statistic from './Statistic';\nimport { formatCountdown } from './utils';\nconst REFRESH_INTERVAL = 1000 / 30;\nfunction getTime(value) {\n    return interopDefault(moment)(value).valueOf();\n}\nclass Countdown extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.syncTimer = () => {\n            const { value } = this.props;\n            const timestamp = getTime(value);\n            if (timestamp >= Date.now()) {\n                this.startTimer();\n            }\n            else {\n                this.stopTimer();\n            }\n        };\n        this.startTimer = () => {\n            if (this.countdownId)\n                return;\n            this.countdownId = window.setInterval(() => {\n                this.forceUpdate();\n            }, REFRESH_INTERVAL);\n        };\n        this.stopTimer = () => {\n            const { onFinish, value } = this.props;\n            if (this.countdownId) {\n                clearInterval(this.countdownId);\n                this.countdownId = undefined;\n                const timestamp = getTime(value);\n                if (onFinish && timestamp < Date.now()) {\n                    onFinish();\n                }\n            }\n        };\n        this.formatCountdown = (value, config) => {\n            const { format } = this.props;\n            return formatCountdown(value, Object.assign(Object.assign({}, config), { format }));\n        };\n        // Countdown do not need display the timestamp\n        this.valueRender = (node) => React.cloneElement(node, {\n            title: undefined,\n        });\n    }\n    componentDidMount() {\n        this.syncTimer();\n    }\n    componentDidUpdate() {\n        this.syncTimer();\n    }\n    componentWillUnmount() {\n        this.stopTimer();\n    }\n    render() {\n        return (<Statistic valueRender={this.valueRender} {...this.props} formatter={this.formatCountdown}/>);\n    }\n}\nCountdown.defaultProps = {\n    format: 'HH:mm:ss',\n};\npolyfill(Countdown);\nexport default Countdown;\n"],"file":"Countdown.js"}